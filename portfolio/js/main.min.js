var $event,$special,resizeTimeout,BLANK,Grid;$(function(){Grid.init()}),$event=$.event,$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(b,c){var d=this,e=arguments,a=function(){b.type="debouncedresize",$event.dispatch.apply(d,e)};resizeTimeout&&clearTimeout(resizeTimeout),c?a():resizeTimeout=setTimeout(a,$special.threshold)},threshold:250},BLANK='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==',$.fn.imagesLoaded=function(c){var d=this,a=$.isFunction($.Deferred)?$.Deferred():0,j=$.isFunction(a.notify),b=d.find('img').add(d.filter('img')),g=[],h=[],e=[];$.isPlainObject(c)&&$.each(c,function(b,d){b==='callback'?c=d:a&&a[b](d)});function i(){var f=$(h),g=$(e);a&&(e.length?a.reject(b,f,g):a.resolve(b)),$.isFunction(c)&&c.call(d,b,f,g)}function f(c,d){if(c.src===BLANK||$.inArray(c,g)!==-1)return;g.push(c),d?e.push(c):h.push(c),$.data(c,'imagesLoaded',{isBroken:d,src:c.src}),j&&a.notifyWith($(c),[d,b,$(h),$(e)]),b.length===g.length&&(setTimeout(i),b.unbind('.imagesLoaded'))}return b.length?b.bind('load.imagesLoaded error.imagesLoaded',function(a){f(a.target,a.type==='error')}).each(function(d,a){var c=a.src,b=$.data(a,'imagesLoaded');if(b&&b.src===c){f(a,b.isBroken);return}if(a.complete&&a.naturalWidth!==void 0){f(a,a.naturalWidth===0||a.naturalHeight===0);return}(a.readyState||a.complete)&&(a.src=BLANK,a.src=c)}):i(),a?a.promise(d):d},Grid=function(){var m=$('*#og-grid'),b=m.children('li'),d=-1,f=-1,g=0,l=10,j=$(window),c,v=$('html, body'),w={WebkitTransition:'webkitTransitionEnd',MozTransition:'transitionend',OTransition:'oTransitionEnd',msTransition:'MSTransitionEnd',transition:'transitionend'},i=w[Modernizr.prefixed('transition')],e=Modernizr.csstransitions,a={minHeight:500,speed:350,easing:'ease'};function t(){b=m.children('li'),k(!0)}function q(b){a=$.extend(!0,{},a,b),m.imagesLoaded(function(){k(!0),n(),s()})}function r(a){b=b.add(a),a.each(function(){var a=$(this);a.data({offsetTop:a.offset().top,height:a.height()})}),p(a)}function k(a){b.each(function(){var b=$(this);b.data('offsetTop',b.offset().top),a&&b.data('height',b.height())})}function s(){p(b),j.on('debouncedresize',function(){g=0,f=-1,k(),n();var a=$.data(this,'preview');typeof a!='undefined'&&h()})}function p(a){a.on('click','span.og-close',function(){return h(),!1}).children('a').on('click',function(c){var b=$(this).parent();return d===Array.from(a).findIndex(a=>a==b[0])?h():u(b),!1})}function n(){c={width:j.width(),height:j.height()}}function u(b){var a=$.data(this,'preview'),c=b.data('offsetTop');if(g=0,typeof a!='undefined')if(f!==c)c>f&&(g=a.height),h();else return a.update(b),!1;f=c,a=$.data(this,'preview',new o(b)),a.open()}function h(){d=-1;var a=$.data(this,'preview');a.close(),$.removeData(this,'preview')}function o(a){this.$item=a,this.expandedIdx=Array.from(b).findIndex(a=>a==this.$item[0]),this.create(),this.update()}return o.prototype={create:function(){this.$title=$('<h3></h3>'),this.$description=$('<p></p>'),this.$href=$('<a href="#" target="_blank"></a>'),this.$exifInfo=$('<ul class="exif"></ul>'),this.$collectionName=$('<div class="stamp"></div>'),this.$details=$('<div class="og-details"></div>').append(this.$collectionName,this.$title,this.$description,this.$exifInfo,this.$href),this.$loading=$('<div class="og-loading"></div>'),this.$fullimage=$('<div class="og-fullimg"></div>').append(this.$loading),this.$closePreview=$('<span class="og-close"></span>'),this.$previewInner=$('<div class="og-expander-inner"></div>').append(this.$fullimage,this.$details,this.$closePreview),this.$previewEl=$('<div class="og-expander"></div>').append(this.$previewInner),this.$item.append(this.getEl()),e&&this.setTransition()},update:function(f){var g,e,a,c;f&&(this.$item=f),d!==-1&&(g=b.eq(d),g.removeClass('og-expanded'),this.$item.addClass('og-expanded'),this.positionPreview()),d=this.$item.index(),e=this.$item.children('a'),a={href:e.attr('href'),largesrc:e.data('largesrc'),title:e.data('title'),description:e.data('description'),exif:e.data('exif'),buttontext:e.data('buttontext'),collectionName:e.data('collection'),isVideo:e.data('is-video')},this.$title.html(a.title),this.$description.html(a.description),a.exif?(this.$exifInfo.html(a.exif),this.$exifInfo.show()):this.$exifInfo.hide(),a.collectionName?(this.$collectionName.html(a.collectionName),this.$collectionName.show()):this.$collectionName.hide(),a.buttontext&&this.$href.text(a.buttontext),a.href&&a.buttontext?(this.$href.attr('href',a.href),this.$href.show()):this.$href.hide(),c=this,typeof c.$largeImg!='undefined'&&c.$largeImg.remove(),c.$fullimage.is(':visible')?(this.$loading.show(),a.isVideo?$('<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen/>').on("load",function(){c.$loading.hide()}).attr('src',a.largesrc).fadeIn(350).appendTo(c.$fullimage):$('<img/>').on("load",function(){var a=$(this);c.$loading.hide(),c.$fullimage.find('img').remove(),c.$largeImg=a.fadeIn(350),c.$fullimage.append(c.$largeImg)}).attr('src',a.largesrc)):a.isVideo&&$('<a target="_blank"/>').attr("href",a.largesrc).appendTo(c.$title)},open:function(){setTimeout($.proxy(function(){this.setHeights(),this.positionPreview()},this),25)},close:function(){var a=this,c=function(){e&&$(this).off(i),a.$item.removeClass('og-expanded'),a.$previewEl.remove()};return setTimeout($.proxy(function(){typeof this.$largeImg!='undefined'&&this.$largeImg.fadeOut('fast'),this.$previewEl.css('height',0);var a=b.eq(this.expandedIdx);a.css('height',a.data('height')).on(i,c),e||c.call()},this),25),!1},calcHeight:function(){var b=c.height-this.$item.data('height')-l,d=c.height;b<a.minHeight&&(b=a.minHeight,d=a.minHeight+this.$item.data('height')+l),this.height=b,this.itemHeight=d},setHeights:function(){var a=this,b=function(){e&&a.$item.off(i),a.$item.addClass('og-expanded')};this.calcHeight(),this.$previewEl.css('height',this.height),this.$item.css('height',this.itemHeight).on(i,b),e||b.call()},positionPreview:function(){var d=this.$item.data('offsetTop'),b=this.$previewEl.offset().top-g,e=this.height+this.$item.data('height')+l<=c.height?d:this.height<c.height?b-(c.height-this.height):b;v.animate({scrollTop:e},a.speed)},setTransition:function(){this.$previewEl.css('transition','height '+a.speed+'ms '+a.easing),this.$item.css('transition','height '+a.speed+'ms '+a.easing)},getEl:function(){return this.$previewEl}},{init:q,addItems:r,updateList:t}}(),document.addEventListener("DOMContentLoaded",function(){var a=document.querySelectorAll("img.lazy"),b;"IntersectionObserver"in window?(b=new IntersectionObserver(function(a,c){a.forEach(function(c){if(c.isIntersecting){var a=c.target;$(a).on("load",function(){a.classList.remove("lazy"),a.style.removeProperty("width")}).attr('src',a.dataset.src),b.unobserve(a)}})}),a.forEach(function(a){b.observe(a)})):a.forEach(function(a){a.src=a.dataset.src,a.classList.remove('lazy'),a.style.removeProperty("width")})})